<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Cancel Order Getting Async BSFN Error For Few Users (P4210)</title>
<!--     <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/styles.css"> -->
    <link href='https://fonts.googleapis.com/css?family=Oxygen:400,300,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Lora' rel='stylesheet' type='text/css'>

    <style>
      body {
        font-family: Calibri, Arial, Helvetica, sans-serif;
/*        background-color: #FFFAFA;*/
/*        font-size: 14px;*/
      }

      #myBtn {
        display: none;
        position: fixed;
        bottom: 20px;
        right: 30px;
        z-index: 99;
        font-size: 18px;*/
        border: none;
        outline: none;
        background-color: #2F4F4F;
        color: white;
        cursor: pointer;
        padding: 15px;
        border-radius: 4px;
      }

      #myBtn:hover {
        background-color: #555;
      }
    </style>

  </head>


<body>
  <header>
    <nav id="header-nav" class="navbar navbar-default">
      <div class="container">
        <div class="navbar-header">
          <a href="index.html" class="pull-left visible-md visible-lg">
            <div id="logo-img"></div>
          </a>

          <div class="navbar-brand">
            <a href="../index.html"><h1>Home Page!</h1></a>
          </div>

<!--           <form>
            <input type="button" value="Go back!" onclick="history.back()">
          </form> -->

        </div>
        
      </div><!-- .container -->
    </nav><!-- #header-nav -->
  </header>

<button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>

<div style="background-color:#2F4F4F;color:white;padding:0px"><h1>Cancel Order Getting Async BSFN Error For Few Users (P4210)</h1></div>
<!-- <div style="background-color:lightgrey;padding:30px 30px 2500px">This example demonstrates how to create a "scroll to top" button that becomes visible when the user starts to scroll the page.</div> -->

<script>
// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    document.getElementById("myBtn").style.display = "block";
  } else {
    document.getElementById("myBtn").style.display = "none";
  }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>

</body>


<!-- <h1 class="km"><big><big><a name="subtitle"></a><span style="font-size: large;"><BIG>Caching in EnterpriseOne</BIG></span></big></big></h1> -->
<!-- ================================= Purpose of Document ================================== -->

<h2 class="km"><big><big><a name="section01"></a><span style="font-size: medium;"><BIG>Purpose of Document</BIG></span></big></big></h2>

<p>This document is part of an advisor - to see other documents related to Sales, please use the links provided below:</p>
<h2><a href="https://support.oracle.com/oip/faces/secure/km/DocumentDisplay.jspx?id=1342177.2" target="_blank">JD Edwards EnterpriseOne Sales Advisor</a> &gt; <a href="https://support.oracle.com/oip/faces/secure/km/DocumentDisplay.jspx?id=1346792.2&amp;h=Y" target="_blank">JD Edwards EnterpriseOne Sales Troubleshooting Advisor</a> &gt; Note 1110095.1</h2>
<p><br /><br />The audience for this note is someone with developer level knowledge.</p>


<!-- ======================================== Body Starts Here =================================== -->

<p>Cancellation of existing Sales Order issues Commit Fail error when, </p>
<ul>
<li>SO is created based on SQ</li>
<li>'Status Code - Next' (NXTR) from table F4211 is 560</li>
<li>By canceling LTTR = "980" and NXTR = "999"</li>
<li>(Inclusive) Row Security is set as below:</li>
</ul>
<table class="km" style="width: 100%;" border="1" cellspacing="1" cellpadding="1">
<tbody>
<tr><th class="km" style="width: 11%;">User</th><th class="km" style="width: 11%;">Table</th><th class="km" style="width: 11%;">Col</th><th class="km" style="width: 11%;">From</th><th class="km" style="width: 11%;">To</th><th class="km" style="width: 11%;">Add</th><th class="km" style="width: 11%;">Change</th><th class="km" style="width: 11%;">Delete</th><th class="km" style="width: 11%;">View</th></tr>
<tr>
<td class="km" style="width: 11%;">UserA</td>
<td class="km" style="width: 11%;">F4211</td>
<td class="km" style="width: 11%;">NXTR</td>
<td class="km" style="width: 11%;">500</td>
<td class="km" style="width: 11%;">509</td>
<td class="km" style="width: 11%;">N</td>
<td class="km" style="width: 11%;">N</td>
<td class="km" style="width: 11%;">N</td>
<td class="km" style="width: 11%;">N</td>
</tr>
<tr>
<td class="km" style="width: 11%;">UserA</td>
<td class="km" style="width: 11%;">F4211</td>
<td class="km" style="width: 11%;">NXTR</td>
<td class="km" style="width: 11%;">510</td>
<td class="km" style="width: 11%;">999</td>
<td class="km" style="width: 11%;">Y</td>
<td class="km" style="width: 11%;">Y</td>
<td class="km" style="width: 11%;">Y</td>
<td class="km" style="width: 11%;">Y</td>
</tr>
</tbody>
</table>
<p><br />And Order Activity Rules are defined as below for SO and SQ type orders:<br /><br /></p>
<table class="km" style="width: 100%;" border="1" cellspacing="1" cellpadding="1">
<tbody>
<tr><th class="km">Order<br />Type</th><th class="km">Line<br />Type</th><th class="km">Last<br />Status</th><th class="km">Description</th><th class="km">Next<br />Status</th></tr>
<tr>
<td class="km">SQ</td>
<td class="km">S</td>
<td class="km">500</td>
<td class="km">Enter Quote Order</td>
<td class="km">505</td>
</tr>
<tr>
<td class="km">SQ</td>
<td class="km">S</td>
<td class="km">505</td>
<td class="km">Ready to Create SO</td>
<td class="km">510</td>
</tr>
<tr>
<td valign="top">SQ</td>
<td valign="top">S</td>
<td valign="top">...</td>
<td valign="top">&nbsp;</td>
<td valign="top">&nbsp;</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<table class="km" style="width: 100%;" border="1" cellspacing="1" cellpadding="1">
<tbody>
<tr><th class="km" style="width: 20%;">Order<br />Type</th><th class="km" style="width: 20%;">Line<br />Type</th><th class="km" style="width: 20%;">Last<br />Status</th><th class="km" style="width: 20%;">Description</th><th class="km" style="width: 20%;">Next<br />Status</th></tr>
<tr>
<td class="km" style="width: 20%;">SO</td>
<td class="km" style="width: 20%;">S</td>
<td class="km" style="width: 20%;">510</td>
<td class="km" style="width: 20%;">Enter Sales Order&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </td>
<td class="km" style="width: 20%;">540</td>
</tr>
<tr>
<td class="km" style="width: 20%;">SO</td>
<td class="km" style="width: 20%;">S</td>
<td class="km" style="width: 20%;">540</td>
<td class="km" style="width: 20%;">...</td>
<td class="km" style="width: 20%;">&nbsp;</td>
</tr>
</tbody>
</table>
<p><br />All the setting appears to be valid as Next Status is 560 to be moved to next status is 999 but ASYNCHRONOUS BUSINESS FUNCTION ERROR against Business Function F4211FSEndDoc is issued and jde.log leave message as below:</p>
<div class="kmnotebox">1952/2160 WRK:TESTFBA_050DC240_P4210 Wed May 26 01:26:37.896050 <em>Jdb_exef.c826</em><br /><strong>JDB9900900 - Inclusive Row Level Security Violation: UserA attempted an UPDATE on column SDNXTR in table F4211</strong><br /><br />1952/2160 WRK:TESTFBA_050DC240_P4210 Wed May 26 01:26:37.896052 <em>Jdb_exet.c8094</em><br />JDB9901232 - Canceling transaction because: TC031 UpdateTable: security violation</div>
<h3 class="km">What is problem and how to overcome this error?</h3>
<p>Error is caused by Row Security in updating SQ order line. As Bug <a href="&lt;&lt;INLINE_BUG:12498818&gt;&gt;" target="_blank">12498818</a> - "<em>Re-Open Blanket Order in case of the quantity releases decreased</em>" indicates, the SQ quantity has to be replenished in canceling Sales Order which is derived from Sales Quote. <br /><br />Since cancellation has to update quantity and status (F4211.NXTR) for SQ into 505 it ends in error as 505 wasn't included in the security.<br /><br /></p>
<div class="kmnotebox">Note: <br />
<ul>
<li>This routine is written at BSFN B4200490 - <em>RelieveSOBlanketOrderQty </em>(F4211 Update Blanket Release Quantity) which is called by B4200310 - <em>F4211FSEndDoc </em>(F4211 End Document)</li>
<li>Since security method is inclusive row security the first row (where it meets Column 'Change' and Value 'N') won't be referred</li>
<li>So DML statement might be SQL&gt; UPDATE PRODDTA.F4211 SET SDNXTR = '505' WHERE (SDDCTO = 'SQ' AND SDDOCO = mnS/ONumber AND ...) AND (SDNXTR BETWEEN '510' AND '999')</li>
<li>So error message will issued in testing WHERE clause as Row Security Setting conflicts with (SDNXTR BETWEEN '510' AND '999')</li>
<li><strong>To verify this capture jdedebug.log without having row security and determine which routine ends in error. This is important, as stated above, error is to be issued in TESTING WHERE clause so error log does not contain any hint on why it fails</strong></li>
</ul>
</div>
<p><br />To overcome this error correct Row Security settings by allowing NXTR = 505<br /><br /></p>
<table class="km" style="width: 100%;" border="1" cellspacing="1" cellpadding="1">
<tbody>
<tr><th class="km" style="width: 11%;">User</th><th class="km" style="width: 11%;">Table</th><th class="km" style="width: 11%;">Col</th><th class="km" style="width: 11%;">From</th><th class="km" style="width: 11%;">To</th><th class="km" style="width: 11%;">Add</th><th class="km" style="width: 11%;">Change</th><th class="km" style="width: 11%;">Delete</th><th class="km" style="width: 11%;">View</th></tr>
<tr>
<td class="km" style="width: 11%;">UserA</td>
<td class="km" style="width: 11%;">F4211</td>
<td class="km" style="width: 11%;">NXTR</td>
<td class="km" style="width: 11%;">505</td>
<td class="km" style="width: 11%;">999</td>
<td class="km" style="width: 11%;">Y</td>
<td class="km" style="width: 11%;">Y</td>
<td class="km" style="width: 11%;">Y</td>
<td class="km" style="width: 11%;">Y</td>
</tr>
</tbody>
</table>
<p><br />or do not set inclusive row security for column Change.<br /><br /><em><strong>Disclaimer: Oracle is not responsible for transaction failure which is caused by incorrect Row Security settings</strong></em>. <br /><br /></p>
<div class="kmnotebox">To discuss information further with Oracle experts and industry peers, we encourage you to review, join or start a discussion in the <a href="https://community.oracle.com/community/support/jdedwards_enterpriseone/distribution_-_jde1" target="_blank">JDE1 Distribution Community</a>.<br /> <br /> To look at upcoming or archived Advisor Webcasts please see Advisor Webcast Details (Doc ID <a href="&lt;&lt;INLINE_NOTE:548764.1&gt;&gt;" target="_blank">548764.1</a>) if your topic is not currently scheduled please suggest it.</div>



<!-- ======================================== End of Body ==================================== -->

  <footer class="panel-footer">
    <div class="container">
      <div class="row">
        <section id="pagebottom" class="pagebottom">
          <!-- <p>"Click Top button to go back to the top"</p> -->
          <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
          <form>
            <input type="button" value="Go back!" onclick="history.back()">
          </form>
        </section>
      </div>
      <div class="text-center">&copy; Copyright Dong's Page 2019</div>
    </div>
  </footer>

  <!-- jQuery (Bootstrap JS plugins depend on it) -->
  <script src="../js/jquery-2.1.4.min.js"></script>
  <script src="../js/bootstrap.min.js"></script>
  <script src="../js/script.js"></script>
</body>
</html>
