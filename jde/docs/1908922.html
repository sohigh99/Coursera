<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>How to e-mail Accounts Payable Payment Print PDFs to Suppliers using Report Definitions</title>
<!--     <link rel="stylesheet" href="../css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/styles.css"> -->
    <link href='https://fonts.googleapis.com/css?family=Oxygen:400,300,700' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Lora' rel='stylesheet' type='text/css'>

    <style>
      body {
        font-family: "Segoe UI", Calibri, Arial, Helvetica, sans-serif;
/*        background-color: #FFFAFA;*/
/*        font-size: 14px;*/
      }

      #myBtn {
        display: none;
        position: fixed;
        bottom: 20px;
        right: 30px;
        z-index: 99;
        font-size: 18px;*/
        border: none;
        outline: none;
        background-color: #2F4F4F;
        color: white;
        cursor: pointer;
        padding: 15px;
        border-radius: 4px;
      }

      #myBtn:hover {
        background-color: #555;
      }
        .kmnotebox {
        background-color: #FFFFE0;
        border-left: 10px;
        /*border-style: dotted;*/
      }

      .kmcodeblock {
        background-color: #B0E0E6;
        border-left: 10px;
        margin-left: 2%;
        /*border-style: dotted;*/
      }

      
    </style>

  </head>


<body>
  <header>
    <nav id="header-nav" class="navbar navbar-default">
      <div class="container">
        <div class="navbar-header">
          <a href="index.html" class="pull-left visible-md visible-lg">
            <div id="logo-img"></div>
          </a>

          <div class="navbar-brand">
            <a href="../index.html"><h1>Home Page!</h1></a>
          </div>

<!--           <form>
            <input type="button" value="Go back!" onclick="history.back()">
          </form> -->

        </div>

      </div><!-- .container -->
    </nav><!-- #header-nav -->
  </header>

<button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>

<div style="background-color:#2F4F4F;color:white;padding:0px"><h1>How to e-mail Accounts Payable Payment Print PDFs to Suppliers using Report Definitions</h1></div>
<!-- <div style="background-color:lightgrey;padding:30px 30px 2500px">This example demonstrates how to create a "scroll to top" button that becomes visible when the user starts to scroll the page.</div> -->

<script>
// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    document.getElementById("myBtn").style.display = "block";
  } else {
    document.getElementById("myBtn").style.display = "none";
  }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>

</body>


<!-- <h1 class="km"><big><big><a name="subtitle"></a><span style="font-size: large;"><BIG>Caching in EnterpriseOne</BIG></span></big></big></h1> -->
<!-- ================================= Purpose of Document ================================== -->

<table><tr><td width='0'></td><td><A HREF="#PURPOSE">Purpose</A></td></tr></table>
<table><tr><td width='0'></td><td><A HREF="#SCOPE">Scope</A></td></tr></table>
<table><tr><td width='0'></td><td><A HREF="#BODYTEXT">Details</A></td></tr></table>
<table><tr><td width=0>&nbsp;</td><td><a href="#aref_section31">Solution</a></td></tr></table>
<table><tr><td width=20>&nbsp;</td><td><a href="#aref_section32"><strong>Overview</strong></a></td></tr></table>
<table><tr><td width=20>&nbsp;</td><td><a href="#aref_section33"><strong>Steps to e-mail Accounts Payable Checks (Print Automatic Payments &ndash; Standard/R04572) to Suppliers using Report Definitions</strong></a></td></tr></table>
<table><tr><td width=40>&nbsp;</td><td><a href="#aref_section34"><strong>1. </strong><strong>Prepare a sample payment group with payments to a few suppliers using a Payment Instrument associated with a version of R04572 </strong></a></td></tr></table>
<table><tr><td width=40>&nbsp;</td><td><a href="#aref_section35"><strong>2. Add a blank RTF Template to BI Publisher Object Repository (P95600) </strong></a></td></tr></table>
<table><tr><td width=40>&nbsp;</td><td><a href="#aref_section36"><strong>3. </strong><strong>Create a Report Definition using the blank RTF Template from step 2 in order to produce the XML Source of the R04572 report</strong></a></td></tr></table>
<table><tr><td width=40>&nbsp;</td><td><a href="#aref_section37"><strong>4. </strong><strong>Associate the Report Definition from step 3 with the version of the R04572 report version from step 1</strong></a></td></tr></table>
<table><tr><td width=40>&nbsp;</td><td><a href="#aref_section38"><strong>5. </strong><strong>Write the payment group (P04571) from step 1 and save the XML Source for the R04572</strong></a></td></tr></table>
<table><tr><td width=40>&nbsp;</td><td><a href="#aref_section39"><strong>6. </strong><strong>Using the XML Source and the Oracle BI Publisher Template Builder create a new RTF Template file to display payment information</strong></a></td></tr></table>
<table><tr><td width=40>&nbsp;</td><td><a href="#aref_section310"><strong>7. </strong><strong>Add the Template from step 6 to the BI Publisher Object Repository</strong></a></td></tr></table>
<table><tr><td width=40>&nbsp;</td><td><a href="#aref_section311"><strong>8. </strong><strong>Modify the Report Definition from step 2 to use the Template just created and set up bursting and delivery options</strong></a></td></tr></table>
<table><tr><td width=40>&nbsp;</td><td><a href="#aref_section312"><strong>9. </strong><strong>In the Burst/Delivery screen set up the e-mailing options</strong></a></td></tr></table>
<table><tr><td width=40>&nbsp;</td><td><a href="#aref_section313"><strong>10. </strong><strong>Reset the Payment group and Write again (P04571). Notice it sent e-mails to each supplier with the pages of R04572 that contained the specific payments to each supplier</strong></a></td></tr></table>
<table><tr><td width=20>&nbsp;</td><td><a href="#aref_section314"><strong>Additional Information</strong></a></td></tr></table>
<hr size=1><p>


<H2 class=km><A NAME="PURPOSE"></A>Purpose</H2>
<p>This document describes how to e-mail payment details or checks to Suppliers using Report Definitions.</p>
<H2 class=km><A NAME="SCOPE"></A>Scope</H2>
<p> </p>
<H2 class=km><A NAME="BODYTEXT"></A>Details</H2>
<p>With Report Definitions it is possible to make a Report Version run a Report Definition whenever the Report Version is called. Then instead of producing the regular PDF output, the UBE produces and delivers the output as specified in the Report Definition. Using this feature in Accounts Payable, it is possible to send e-mails with information based on the Payment Print UBE output to Suppliers.</p>
<a name="aref_section31"></a><h2>Solution</h2>
<a name="aref_section32"></a><h3 class="km"><strong>Overview</strong></h3>
<p>JD Edwards EnterpriseOne Report Definition are JDE objects that specify the report that produces the data for the embedded BI Publisher(XML Publisher) component to process, instructions on how to process the data and produce output (templates), and instructions on how to deliver the output produced.</p>
<p>When running a Report Definition the system first creates an XML output (called XML Source) in a BLOB stored in the database. The XML Source is the UBE output in XML format. It contains XML Elements for the UBE sections and fields. The XML Source Elements are transformed/listed following the instructions specified in a Template based on the XSL standard. Template files can be in different formats like: PDF, RTF, EXCEL, XSL. The result of this process is the Report Definition Output (RD Output). In BI Publisher terms: <em>the XML Source is merged with the Template to produce the RD Output</em>. The RD Output can also be in different formats like: PDF, RTF, Word, Excel, XML or others. In the end the RD Output is delivered according to the delivery instructions from the Report Definition. Both the XML Source and the RD Output can be downloaded to files from Report Definition Jobs (P95630).</p>
<p><strong>Process Diagram</strong></p>
<p><img src="../images/xml01.png" border="1" alt="1" title="1" hspace="0" vspace="0"/></p>
<p>To create a Report Definition, one needs to associate a JD Edwards UBE version with a BI Publisher Template and set up delivery instructions. The RD Output is generated based on the XML Elements from the XML Source. To obtain the XML Source, first run a Report Definition with the desired UBE version and a blank Template. This produces the XML Source with the XML output for the UBE version and a blank RD Output file. After this step, using the XML Elements from the XML Source, a Template that produces meaningful RD Output can be created.</p>
<p> </p>
<div class="kmnotebox">
<p>Notes:</p>
<p>1. This is just an example. You may need to change/adapt it to your specific requirements. As a general rule Oracle Support does not assist with creating custom programs or modifications. But if you have specific questions related to creating Report Definitions or Report Definitions features we may ask you to create Service Requests for the Support Group that handles Report Definitions. If you have specific questions related to BI Publisher Templates and how they work we may ask to create Service Requests for the Support Group that handles BI Publisher.</p>
<p>2. If you plan to implement such a solution please be advised that the basic e-mail protocol is inherently insecure as e-mails go through potentially untrusted intermediate computers (email servers, ISPs) before reaching their destination, and there is no way to tell if they were accessed by an unauthorized entity. There are various technological workarounds to overcome this inherent vulnerability, but they are not discussed in this document and you need to find the most appropriate way to secure the e-mails sent.</p>
</div>
<p> </p>
<p> </p>
<a name="aref_section33"></a><h3 class="km"><strong>Steps to e-mail Accounts Payable Checks (Print Automatic Payments &ndash; Standard/R04572) to Suppliers using Report Definitions</strong></h3>
<a name="aref_section34"></a><h4 class="km"><strong>1. </strong><strong>Prepare a sample payment group with payments to a few suppliers using a Payment Instrument associated with a version of R04572 </strong></h4>
<p>Create a Payment Group (R04570) with a few payments including one with multiple Pay Items:</p>
<p><img src="../images/xml02.png" border="1" alt="2" title="2" hspace="0" vspace="0"/></p>
<div class="WordSection1">
<p>Make sure the Suppliers are setup with e-mail Address in the Who&rsquo;s Who (P0111) under Row Exit Email/Internet:</p>
<p><img src="../images/xml03.png" border="1" alt="3" title="3" hspace="0" vspace="0"/></p>
<p>Use a Payment Instrument set up to call a certain version of the R04572. Verify this in Work With Payment Control Groups (P04571), Row Exit Controls:</p>
<p><img src="../images/xml04.png" border="1" alt="4" title="4" hspace="0" vspace="0"/></p>
<hr />
<a name="aref_section35"></a><h4 class="km"><strong>2. Add a blank RTF Template to BI Publisher Object Repository (P95600) </strong></h4>
<p>Create the blank RTF file and make sure to actually Open and Save the file before uploading it to the BI Publisher Object Repository. In the BI Publisher Object Repository (P95600) press Add then fill the information in the Update BI Publisher Object Repository screen:</p>
<p><img src="../images/xml05.png" border="1" alt="5" title="5" hspace="0" vspace="0"/></p>
<p>Press OK, and then select the blank RTF file in the file selection box:</p>
<p><img src="../images/xml06.png" border="1" alt="6" title="6" hspace="0" vspace="0"/></p>
<p>Enter a Start Date under Effective Dates and press OK to upload the Template.</p>
<hr />
<a name="aref_section36"></a><h4 class="km"><strong>3. </strong><strong>Create a Report Definition using the blank RTF Template from step 2 in order to produce the XML Source of the R04572 report</strong></h4>
<p>In Report Definitions (P95620) press Add then complete the UBE, version and Template for the RD:</p>
<p><img src="../images/xml07.png" border="1" alt="7" title="7" hspace="0" vspace="0"/></p>
<p>Take Form Exit Next and set up Output Type and Language options:</p>
<p><img src="../images/xml08.png" border="1" alt="8" title="8" hspace="0" vspace="0"/></p>
<p>Press Next again and at this time do not set any Bursting/Delivery options:</p>
<p><img src="../images/xml09.png" border="1" alt="9" title="9" hspace="0" vspace="0"/></p>
<hr />
<a name="aref_section37"></a><h4 class="km"><strong>4. </strong><strong>Associate the Report Definition from step 3 with the version of the R04572 report version from step 1</strong></h4>
<p>Go to Work with Batch Versions, Select the R04572 version from step 1 and take Row Exit Version Detail (Make sure the version is checked out):</p>
<p><img src="../images/xml10.png" border="1" alt="10" title="10" hspace="0" vspace="0"/></p>
<p>In the next screen take Form Exit Report Definition:</p>
<p><img src="../images/xml11.png" border="1" alt="11" title="11" hspace="0" vspace="0"/></p>
<p>In the Report Definition screen associate the version with the Report Definition from step 3 then save the changes:</p>
<p><img src="../images/xml12.png" border="1" alt="12" title="12" hspace="0" vspace="0"/></p>
<p>After this step, whenever the version of the report is called, the system calls the Report Definition.</p>
<hr />
<a name="aref_section38"></a><h4 class="km"><strong>5. </strong><strong>Write the payment group (P04571) from step 1 and save the XML Source for the R04572</strong></h4>
<p>Write the payment control group from step 1.</p>
<p>Go to Submitted Jobs select the R04572 job and take Row Exit View RD Source and then save the file when prompted:</p>
<p><img src="../images/xml13.png" border="1" alt="13" title="13" hspace="0" vspace="0"/></p>
<p><img src="../images/xml14.png" border="1" alt="14" title="14" hspace="0" vspace="0"/></p>
<p>The XML Source for the R04572 report contains the information from the R04572 in XML format instead of the regular PDF format.</p>
Opened in Internet Explorer it looks as follows. Notice the XML Elements corresponding to the content of the report:
<p><img src="../images/xml15.png" border="1" alt="15" title="15" hspace="0" vspace="0"/></p>
<p>Notice that sections that are repeated in the PDF are repeated in the XML file. For instance the Driver_Section_S14 which includes payment information or Stub _Detail_S16 which includes Pay Items information.</p>
<p>All these XML Elements can later be rearranged and formatted using an RTF Template. Even more complex processing can be done with an XSL template.</p>
<p>To view the RD Output in Submitted Jobs, select the R04572 job and take Row Exit View RD Output. It will be a blank PDF file because we did not add any Fields in the RTF Template.</p>
<hr />
<a name="aref_section39"></a><h4 class="km"><strong>6. </strong><strong>Using the XML Source and the Oracle BI Publisher Template Builder create a new RTF Template file to display payment information</strong></h4>
<p>To produce a meaningful RD Output file, a different BI Publisher Template is needed. We will create another RTF Template file using a Microsoft Word Plug-In called Oracle BI Publisher Template Builder. This Plug-In comes with the Oracle BI Publisher Desktop program.</p>
<p>To determine the exact version of BI Publisher Desktop that you need to use and how to download it.
<!--   , check document <a href="../docs/650220.html" target="_blank">How to Download BI Publisher Desktop Tool</a>. -->
</p>
<p>Open a new RTF document with Microsoft Word. After installing BI Publisher Desktop, additional menu options are available in the Microsoft Word menu and use those options to create the RTF document:</p>
<p>Depending on the exact BI Publisher Desktop version the BI Publisher menu, the buttons may look slightly different, but the same steps should be followed. BI Publisher Template Builder version 11.1.1.5.0 was used in this document.</p>
<p>First press Sample XML and select the XML Source produced by R04572:</p>
<p><img src="../images/xml16.png" border="1" alt="16" title="16" hspace="0" vspace="0"/></p>
<p><img src="../images/xml17.png" border="1" alt="17" title="17" hspace="0" vspace="0"/></p>
<p><img src="../images/xml18.png" border="1" alt="18" title="18" hspace="0" vspace="0"/></p>
<p>After this step, the BI Publisher Template Builder is able to show Fields in a hierarchical tree with the XML Elements from the R04572 XML Source. The Field menu option displays a selection form from which Fields can be added in the RTF document at the cursor position:</p>
<p><img src="../images/xml19.png" border="1" alt="19" title="19" hspace="0" vspace="0"/></p>
<p><img src="../images/xml20.png" border="1" alt="20" title="20" hspace="0" vspace="0"/></p>
<p>Use Repeating Group menu option for loop like statements:</p>
<p><img src="../images/xml21.png" border="1" alt="21" title="21" hspace="0" vspace="0"/></p>
<p>Define the loop by Field:</p>
<p><img src="../images/xml22.png" border="1" alt="22" title="22" hspace="0" vspace="0"/></p>
<p>Then add the fields and/or text information that you want displayed within each loop enclosed between &ldquo;for-each&rdquo; and &ldquo;end&rdquo; statements:</p>
<p><img src="../images/xml23.png" border="1" alt="23" title="23" hspace="0" vspace="0"/></p>
<p>Nested loops can be created.</p>
<p>Any formatting done via the Microsoft Word formatting menus is applied to the Report Definition output.</p>
<p>Create the following RTF to generate meaningful content:</p>
<p><img src="../images/xml24.png" border="1" alt="24" title="24" hspace="0" vspace="0"/></p>
<p>The first loop is for Driver_Section_S14 which includes payment information and the nested loop is for Stub _Detail_S16 to print Pay Item information.</p>
<p>To view the actual output for merging the XML Source with the RTF Template use the PDF menu option:</p>
<p><img src="../images/xml25.png" border="1" alt="25" title="25" hspace="0" vspace="0"/></p>
<p>Resulting PDF:</p>
<p><img src="../images/xml26.png" border="1" alt="26" title="26" hspace="0" vspace="0"/></p>
 <span class="awizStartDelimiter"> </span>
<div class="kmnotebox">
<p><strong>Note:</strong></p>
<p>This is only a simple example created as a demo. One can create different templates to produce more complex output including images and formatting to match their specific requirements.</p>
</div>
<ul>
<li>If you need to add MICR fonts in the template see document: <a href="../docs/652457.html" target="_blank">Adding a Font to be Used with Embedded Publisher for EnterpriseOne</a></li>
<li>For more details on how to use the BI Publisher Template Builder, check the Help for the Plug-In under Options sub menu.</li>
<li>For BI Publisher Templates information check the Oracle BI Publisher Core Components Guide for your version of Embedded BI Publisher.</li>
</ul>
<hr />
<a name="aref_section310"></a><h4 class="km"><strong>7. </strong><strong>Add the Template from step 6 to the BI Publisher Object Repository</strong></h4>
<p>Go to BI Publisher Object Repository (P95600) and Add the Template:</p>
<p><img src="../images/xml27.png" border="1" alt="27" title="27" hspace="0" vspace="0"/></p>
<p>Select the RTF file created in step 6:</p>
<p><img src="../images/xml28.png" border="1" alt="28" title="28" hspace="0" vspace="0"/></p>
<p>Select a Start Date and then press OK to save the RTF Template.</p>
<hr />
<a name="aref_section311"></a><h4 class="km"><strong>8. </strong><strong>Modify the Report Definition from step 2 to use the Template just created and set up bursting and delivery options</strong></h4>
<p>Go to Report Definitions (P96520) and Select the Report Definition from step 3 and click the Visual Assist for the Template Name and select the Template from step 7:</p>
<p><img src="../images/xml29.png" border="1" alt="29" title="29" hspace="0" vspace="0"/></p>
<p>Press OK and in the Output/Languages screen; do not modify anything.</p>
<hr />
<a name="aref_section312"></a><h4 class="km"><strong>9. </strong><strong>In the Burst/Delivery screen set up the e-mailing options</strong></h4>
<p>Press OK again in Output/Languages screen and in the Burst/Delivery setup Burst/Delivery options.</p>
<p>Examine the XML Output from step 5 and identify the level break section to burst by and the address book tags as follows:</p>
<p><img src="../images/xml30.png" border="1" alt="30" title="30" hspace="0" vspace="0"/></p>
<p>Set up the Burst field with the XPath to the Address Book field and the Data Driven Recipient (Address Book to whom to e-mail the output) then press OK to save:</p>
<p><img src="../images/xml31.png" border="1" alt="31" title="31" hspace="0" vspace="0"/></p>
<hr />
<a name="aref_section313"></a><h4 class="km"><strong>10. </strong><strong>Reset the Payment group and Write again (P04571). Notice it sent e-mails to each supplier with the pages of R04572 that contained the specific payments to each supplier</strong></h4>
<p><img src="../images/xml32.png" border="1" alt="32" title="32" hspace="0" vspace="0"/></p>
<p><img src="../images/xml33.png" border="1" alt="33" title="33" hspace="0" vspace="0"/></p>
<p> </p>
<a name="aref_section314"></a><h3 class="km"><strong>Additional Information</strong></h3>
<p>See more on how to setup custom Subject and Body for Data Driven e-mails in:</p>

<p><a href="../docs/1103153.html" target="_blank">How to Setup Dynamic Subject and Body for E-mail Delivery?</a></p>
<p>See more on setting Data Driven Delivery in:</p>
<p><a href="../docs/659178.html" target="_blank">xample of Using Data Driven E-Mail with Embedded BI Publisher for EnterpriseOne</a></p>
<p> </p>





<!-- ======================================== End of Body ==================================== -->

  <footer class="panel-footer">
    <div class="container">
      <div class="row">
        <section id="pagebottom" class="pagebottom">
          <!-- <p>"Click Top button to go back to the top"</p> -->
          <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
          <form>
            <input type="button" value="Go back!" onclick="history.back()">
          </form>
        </section>
      </div>
      <div class="text-center">&copy; Copyright Dong's Page 2019</div>
    </div>
  </footer>

  <!-- jQuery (Bootstrap JS plugins depend on it) -->
  <script src="../js/jquery-2.1.4.min.js"></script>
  <script src="../js/bootstrap.min.js"></script>
  <script src="../js/script.js"></script>
</body>
</html>
